<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Celia" />

<meta name="date" content="2021-10-25" />

<title>Beers Team Project</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="site_libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="site_libs/plotly-binding-4.9.2/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.52.2/plotly-latest.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Celia Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="Brewery-Project-Code.html">Brewery Project</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Beers Team Project</h1>
<h4 class="author">Celia</h4>
<h4 class="date">10/25/2021</h4>

</div>


<div id="establish-libraries" class="section level1">
<h1>Establish Libraries</h1>
<pre class="r"><code>library(ggplot2)
library(plotly)
library(lattice)
library(tidyverse)
library(class)
library(caret)
library(e1071)
library(xlsx)
library(stats)</code></pre>
<div id="code-from-week2-since-eda-will-be-presented" class="section level2">
<h2>Code from week2 since EDA will be presented</h2>
<div id="libraries-for-visualization-techniques-are-needed" class="section level3">
<h3>Libraries for visualization techniques are needed</h3>
<pre class="r"><code>library(MASS)
library(dplyr)
library(readr)
library(GGally)
library(plotly)
library(ggthemes)
library(geofacet) #for geographic-based facets
library(naniar) #help with missing values
library(leaflet) #for map visualization</code></pre>
</div>
</div>
<div id="prepare-data" class="section level2">
<h2>Prepare data</h2>
<pre class="r"><code>### read in dataset
### added Type column to create beer types as factors later on
beer &lt;- read.xlsx(file=&quot;Beers_NEW.xlsx&quot;, sheetIndex = 1,   header=TRUE, stringsAsFactors = FALSE)

### Added state Latitude, Longitude, and Region columns in Excel
brewery &lt;- read.xlsx(file=&quot;Breweries.xlsx&quot;, sheetIndex = 1,   header=TRUE, stringsAsFactors = FALSE)

## View(beer)
head(beer, 10)</code></pre>
<pre><code>##                     Name Beer_ID   ABV IBU Brewery_id                    Style
## 1           Loki Red Ale    2191 0.075  53        202 American Amber / Red Ale
## 2            Devil&#39;s Cup    2265 0.066  NA        178  American Pale Ale (APA)
## 3           Black Exodus    2261 0.077  NA        178            Oatmeal Stout
## 4    Lake Street Express    2260 0.045  NA        178  American Pale Ale (APA)
## 5                Foreman    2259 0.065  NA        178          American Porter
## 6                   Jade    2258 0.055  NA        178  American Pale Ale (APA)
## 7      Sophomoric Saison    2099 0.072  NA        178   Saison / Farmhouse Ale
## 8  Regional Ring Of Fire    2098 0.073  NA        178   Saison / Farmhouse Ale
## 9            Garce SelÃ©    2097 0.069  NA        178   Saison / Farmhouse Ale
## 10          Bitter Bitch    1979 0.061  60        178  American Pale Ale (APA)
##    Ounces Type
## 1      16  ALE
## 2      12  ALE
## 3      12  ALE
## 4      12  ALE
## 5      12  ALE
## 6      12  ALE
## 7      12  ALE
## 8      12  ALE
## 9      12  ALE
## 10     12  ALE</code></pre>
<pre class="r"><code>## identify column names
names(beer)</code></pre>
<pre><code>## [1] &quot;Name&quot;       &quot;Beer_ID&quot;    &quot;ABV&quot;        &quot;IBU&quot;        &quot;Brewery_id&quot;
## [6] &quot;Style&quot;      &quot;Ounces&quot;     &quot;Type&quot;</code></pre>
<pre class="r"><code>names(brewery)</code></pre>
<pre><code>## [1] &quot;Brew_ID&quot;   &quot;Name&quot;      &quot;City&quot;      &quot;State&quot;     &quot;Latitude&quot;  &quot;Longitude&quot;
## [7] &quot;Region&quot;</code></pre>
</div>
</div>
<div id="visualizations" class="section level1">
<h1>VISUALIZATIONS</h1>
<div id="begin-prepare-an-interactive-geo-map-of-breweries-by-state" class="section level2">
<h2>Begin prepare an interactive geo map of breweries by state</h2>
<pre class="r"><code>## Set the map useing leaflet library:
leaflet()%&gt;%addTiles()</code></pre>
<div id="htmlwidget-b847e6afd7698498b9c4" style="width:768px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-b847e6afd7698498b9c4">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]}]},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>## Add popup for brewery information
brewery_map &lt;- brewery%&gt;%mutate(popup_info=paste(Name,&quot;&lt;br/&gt;&quot;,City,&quot;&lt;br&gt;&quot;,State,&quot;&lt;br&gt;&quot;))
## Check popup_info column of data added to dataset
head(brewery_map)</code></pre>
<pre><code>##   Brew_ID                         Name      City State Latitude Longitude
## 1     103  King Street Brewing Company Anchorage    AK  61.3025  -158.775
## 2     224 Midnight Sun Brewing Company Anchorage    AK  61.3025  -158.775
## 3     271      Alaskan Brewing Company    Juneau    AK  61.3025  -158.775
## 4     454       Denali Brewing Company Talkeetna    AK  61.3025  -158.775
## 5     459  Kenai River Brewing Company  Soldotna    AK  61.3025  -158.775
## 6     494 Broken Tooth Brewing Company Anchorage    AK  61.3025  -158.775
##      Region                                                 popup_info
## 1 Southeast  King Street Brewing Company &lt;br/&gt; Anchorage &lt;br&gt;  AK &lt;br&gt;
## 2 Southeast Midnight Sun Brewing Company &lt;br/&gt; Anchorage &lt;br&gt;  AK &lt;br&gt;
## 3 Southeast         Alaskan Brewing Company &lt;br/&gt; Juneau &lt;br&gt;  AK &lt;br&gt;
## 4 Southeast       Denali Brewing Company &lt;br/&gt; Talkeetna &lt;br&gt;  AK &lt;br&gt;
## 5 Southeast   Kenai River Brewing Company &lt;br/&gt; Soldotna &lt;br&gt;  AK &lt;br&gt;
## 6 Southeast Broken Tooth Brewing Company &lt;br/&gt; Anchorage &lt;br&gt;  AK &lt;br&gt;</code></pre>
<pre class="r"><code>## Tweak the map with info layout, set circles smaller to enhance visual
leaflet()%&gt;%addTiles()%&gt;%addCircleMarkers(data=brewery_map, lat=~Latitude, lng=~Longitude, radius=~1, popup=~popup_info)</code></pre>
<div id="htmlwidget-7b9621d867b184df71b4" style="width:768px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-7b9621d867b184df71b4">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[61.3025006,61.3025006,61.3025006,61.3025006,61.3025006,61.3025006,61.3025006,32.6010112,32.6010112,32.6010112,34.7519275,34.7519275,34.1682185,34.1682185,34.1682185,34.1682185,34.1682185,34.1682185,34.1682185,34.1682185,34.1682185,34.1682185,34.1682185,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,37.2718745,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,38.9979339,41.5187835,41.5187835,41.5187835,41.5187835,41.5187835,41.5187835,41.5187835,41.5187835,38.8993487,39.145251,39.145251,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,27.9757279,32.6781248,32.6781248,32.6781248,32.6781248,32.6781248,32.6781248,32.6781248,20.46,20.46,20.46,20.46,41.9383166,41.9383166,41.9383166,41.9383166,41.9383166,45.4945756,45.4945756,45.4945756,45.4945756,45.4945756,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.739318,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,39.7662195,38.4987789,38.4987789,38.4987789,37.8222935,37.8222935,37.8222935,37.8222935,30.9733766,30.9733766,30.9733766,30.9733766,30.9733766,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,42.0629398,38.8063524,38.8063524,38.8063524,38.8063524,38.8063524,38.8063524,38.8063524,45.2185133,45.2185133,45.2185133,45.2185133,45.2185133,45.2185133,45.2185133,45.2185133,45.2185133,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,44.9435598,46.4418595,46.4418595,46.4418595,46.4418595,46.4418595,46.4418595,46.4418595,46.4418595,46.4418595,46.4418595,46.4418595,46.4418595,38.3046615,38.3046615,38.3046615,38.3046615,38.3046615,38.3046615,38.3046615,38.3046615,38.3046615,32.5851062,32.5851062,46.6797995,46.6797995,46.6797995,46.6797995,46.6797995,46.6797995,46.6797995,46.6797995,46.6797995,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,35.2145629,47.4678819,41.5008195,41.5008195,41.5008195,41.5008195,41.5008195,44.0012306,44.0012306,44.0012306,40.1430058,40.1430058,40.1430058,34.1662325,34.1662325,34.1662325,34.1662325,38.502032,38.502032,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.7056258,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,40.1903624,35.3097654,35.3097654,35.3097654,35.3097654,35.3097654,35.3097654,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,44.1419049,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,40.9945928,41.5827282,41.5827282,41.5827282,41.5827282,41.5827282,33.62505,33.62505,33.62505,33.62505,44.2126995,35.830521,35.830521,35.830521,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,31.1693363,39.4997605,39.4997605,39.4997605,39.4997605,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,38.0033855,43.8717545,43.8717545,43.8717545,43.8717545,43.8717545,43.8717545,43.8717545,43.8717545,43.8717545,43.8717545,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,38.8993487,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,44.7862968,38.9201705,43.000325,43.000325,43.000325,43.000325],[-158.7750198,-158.7750198,-158.7750198,-158.7750198,-158.7750198,-158.7750198,-158.7750198,-86.6807365,-86.6807365,-86.6807365,-92.1313784,-92.1313784,-111.930907,-111.930907,-111.930907,-111.930907,-111.930907,-111.930907,-111.930907,-111.930907,-111.930907,-111.930907,-111.930907,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-119.2704153,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-105.550567,-72.757507,-72.757507,-72.757507,-72.757507,-72.757507,-72.757507,-72.757507,-72.757507,-77.0145666,-75.4189206,-75.4189206,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.8330166,-83.2229757,-83.2229757,-83.2229757,-83.2229757,-83.2229757,-83.2229757,-83.2229757,-157.505,-157.505,-157.505,-157.505,-93.389798,-93.389798,-93.389798,-93.389798,-93.389798,-114.1424303,-114.1424303,-114.1424303,-114.1424303,-114.1424303,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-89.504139,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-86.441277,-98.3200779,-98.3200779,-98.3200779,-85.7682399,-85.7682399,-85.7682399,-85.7682399,-91.4299097,-91.4299097,-91.4299097,-91.4299097,-91.4299097,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-71.718067,-77.2684162,-77.2684162,-77.2684162,-77.2684162,-77.2684162,-77.2684162,-77.2684162,-69.0148656,-69.0148656,-69.0148656,-69.0148656,-69.0148656,-69.0148656,-69.0148656,-69.0148656,-69.0148656,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-86.4158049,-93.3655146,-93.3655146,-93.3655146,-93.3655146,-93.3655146,-93.3655146,-93.3655146,-93.3655146,-93.3655146,-93.3655146,-93.3655146,-93.3655146,-92.437099,-92.437099,-92.437099,-92.437099,-92.437099,-92.437099,-92.437099,-92.437099,-92.437099,-89.8772196,-89.8772196,-110.044783,-110.044783,-110.044783,-110.044783,-110.044783,-110.044783,-110.044783,-110.044783,-110.044783,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-79.8912675,-100.3022655,-99.680902,-99.680902,-99.680902,-99.680902,-99.680902,-71.5799231,-71.5799231,-71.5799231,-74.7311156,-74.7311156,-74.7311156,-106.0260685,-106.0260685,-106.0260685,-106.0260685,-117.0230604,-117.0230604,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-73.97968,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-82.6692525,-98.7165585,-98.7165585,-98.7165585,-98.7165585,-98.7165585,-98.7165585,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-120.5380993,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-77.6046984,-71.5064508,-71.5064508,-71.5064508,-71.5064508,-71.5064508,-80.9470381,-80.9470381,-80.9470381,-80.9470381,-100.2471641,-85.9785989,-85.9785989,-85.9785989,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-100.0768425,-111.547028,-111.547028,-111.547028,-111.547028,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-79.4587861,-72.4477828,-72.4477828,-72.4477828,-72.4477828,-72.4477828,-72.4477828,-72.4477828,-72.4477828,-72.4477828,-72.4477828,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-77.0145665,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-89.8267049,-80.1816905,-107.5545669,-107.5545669,-107.5545669,-107.5545669],1,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2},null,null,["King Street Brewing Company <br/> Anchorage <br>  AK <br>","Midnight Sun Brewing Company <br/> Anchorage <br>  AK <br>","Alaskan Brewing Company <br/> Juneau <br>  AK <br>","Denali Brewing Company <br/> Talkeetna <br>  AK <br>","Kenai River Brewing Company <br/> Soldotna <br>  AK <br>","Broken Tooth Brewing Company <br/> Anchorage <br>  AK <br>","Sleeping Lady Brewing Company <br/> Anchorage <br>  AK <br>","Back Forty Beer Company <br/> Gadsden <br>  AL <br>","Straight to Ale <br/> Huntsville <br>  AL <br>","Good People Brewing Company <br/> Birmingham <br>  AL <br>","Core Brewing & Distilling Company <br/> Springdale <br>  AR <br>","Ozark Beer Company <br/> Rogers <br>  AR <br>","SanTan Brewing Company <br/> Chandler <br>  AZ <br>","Phoenix Ale Brewery <br/> Phoenix <br>  AZ <br>","Lumberyard Brewing Company <br/> Flagstaff <br>  AZ <br>","Four Peaks Brewing Company <br/> Tempe <br>  AZ <br>","Borderlands Brewing Company <br/> Tucson <br>  AZ <br>","College Street Brewhouse and Pub <br/> Lake Havasu City <br>  AZ <br>","Barrio Brewing Company <br/> Tucson <br>  AZ <br>","Mudshark Brewing Company <br/> Lake Havasu City <br>  AZ <br>","Grand Canyon Brewing Company <br/> Williams <br>  AZ <br>","Prescott Brewing Company <br/> Prescott <br>  AZ <br>","Mogollon Brewing Company <br/> Flagstaff <br>  AZ <br>","Mike Hess Brewing Company <br/> San Diego <br>  CA <br>","Fort Point Beer Company <br/> San Francisco <br>  CA <br>","The Dudes' Brewing Company <br/> Torrance <br>  CA <br>","Ballast Point Brewing Company <br/> San Diego <br>  CA <br>","Anchor Brewing Company <br/> San Francisco <br>  CA <br>","Figueroa Mountain Brewing Company <br/> Buellton <br>  CA <br>","Firestone Walker Brewing Company <br/> Paso Robles <br>  CA <br>","Speakasy Ales & Lagers <br/> San Francisco <br>  CA <br>","Sierra Nevada Brewing Company <br/> Chico <br>  CA <br>","Mission Brewery <br/> San Diego <br>  CA <br>","Mother Earth Brew Company <br/> Vista <br>  CA <br>","Black Market Brewing Company <br/> Temecula <br>  CA <br>","Anderson Valley Brewing Company <br/> Boonville <br>  CA <br>","Modern Times Beer <br/> San Diego <br>  CA <br>","Refuge Brewery <br/> Temecula <br>  CA <br>","Golden Road Brewing <br/> Los Angeles <br>  CA <br>","Santa Cruz Mountain Brewing <br/> Santa Cruz <br>  CA <br>","Headlands Brewing Company <br/> Mill Valley <br>  CA <br>","Saint Archer Brewery <br/> San Diego <br>  CA <br>","Pine Street Brewery <br/> San Francisco <br>  CA <br>","Claremont Craft Ales <br/> Claremont <br>  CA <br>","David's Ale Works <br/> Diamond Springs <br>  CA <br>","Manzanita Brewing Company <br/> Santee <br>  CA <br>","Central Coast Brewing Company <br/> San Luis Obispo <br>  CA <br>","21st Amendment Brewery <br/> San Francisco <br>  CA <br>","Pizza Port Brewing Company <br/> Carlsbad <br>  CA <br>","Ruhstaller Beer Company <br/> Sacramento <br>  CA <br>","Hess Brewing Company <br/> San Diego <br>  CA <br>","Seabright Brewery <br/> Santa Cruz <br>  CA <br>","Mavericks Beer Company <br/> Half Moon Bay <br>  CA <br>","TailGate Beer <br/> San Diego <br>  CA <br>","Armstrong Brewing Company <br/> South San Francisco <br>  CA <br>","Hangar 24 Craft Brewery <br/> Redlands <br>  CA <br>","Devil's Canyon Brewery <br/> Belmont <br>  CA <br>","Monkey Paw Pub & Brewery <br/> San Diego <br>  CA <br>","Butcher's Brewing <br/> Carlsbad <br>  CA <br>","Uncommon Brewers <br/> Santa Cruz <br>  CA <br>","Mammoth Brewing Company <br/> Mammoth Lakes <br>  CA <br>","Ukiah Brewing Company <br/> Ukiah <br>  CA <br>","Great Divide Brewing Company <br/> Denver <br>  CO <br>","Avery Brewing Company <br/> Boulder <br>  CO <br>","Upslope Brewing Company <br/> Boulder <br>  CO <br>","Crazy Mountain Brewing Company <br/> Edwards <br>  CO <br>","Epic Brewing <br/> Denver <br>  CO <br>","New Belgium Brewing Company <br/> Fort Collins <br>  CO <br>","Lone Tree Brewing Company <br/> Lone Tree <br>  CO <br>","Bonfire Brewing Company <br/> Eagle <br>  CO <br>","Renegade Brewing Company <br/> Denver <br>  CO <br>","Steamworks Brewing Company <br/> Durango <br>  CO <br>","Pug Ryan's Brewery <br/> Dillon <br>  CO <br>","Grimm Brothers Brewhouse <br/> Loveland <br>  CO <br>","Odyssey Beerwerks <br/> Arvada <br>  CO <br>","Oskar Blues Brewery <br/> Longmont <br>  CO <br>","High Hops Brewery <br/> Windsor <br>  CO <br>","Big Choice Brewing <br/> Broomfield <br>  CO <br>","Denver Beer Company <br/> Denver <br>  CO <br>","Ska Brewing Company <br/> Durango <br>  CO <br>","Tommyknocker Brewery <br/> Idaho Springs <br>  CO <br>","Black Shirt Brewing Company <br/> Denver <br>  CO <br>","Palisade Brewing Company <br/> Palisade <br>  CO <br>","Pikes Peak Brewing Company <br/> Monument <br>  CO <br>","Eddyline Brewery & Restaurant <br/> Buena Vista <br>  CO <br>","Revolution Brewing <br/> Paonia <br>  CO <br>","Breckenridge Brewery <br/> Denver <br>  CO <br>","Fate Brewing Company <br/> Boulder <br>  CO <br>","Boulder Beer Company <br/> Boulder <br>  CO <br>","Sanitas Brewing Company <br/> Boulder <br>  CO <br>","Gore Range Brewery <br/> Edwards <br>  CO <br>","Redstone Meadery <br/> Boulder <br>  CO <br>","Wynkoop Brewing Company <br/> Denver <br>  CO <br>","Asher Brewing Company <br/> Boulder <br>  CO <br>","Pateros Creek Brewing Company <br/> Fort Collins <br>  CO <br>","Dad & Dude's Breweria <br/> Aurora <br>  CO <br>","Centennial Beer Company <br/> Edwards <br>  CO <br>","River North Brewery <br/> Denver <br>  CO <br>","AC Golden Brewing Company <br/> Golden <br>  CO <br>","Crystal Springs Brewing Company <br/> Boulder <br>  CO <br>","Telluride Brewing Company <br/> Telluride <br>  CO <br>","Dry Dock Brewing Company <br/> Aurora <br>  CO <br>","Oskar Blues Brewery <br/> Lyons <br>  CO <br>","Arctic Craft Brewery <br/> Colorado Springs <br>  CO <br>","Crabtree Brewing Company <br/> Greeley <br>  CO <br>","Twisted Pine Brewing Company <br/> Boulder <br>  CO <br>","Aspen Brewing Company <br/> Aspen <br>  CO <br>","Dolores River Brewery <br/> Dolores <br>  CO <br>","Silverton Brewery <br/> Silverton <br>  CO <br>","Broad Brook Brewing LLC <br/> East Windsor <br>  CT <br>","Thomas Hooker Brewing Company <br/> Bloomfield <br>  CT <br>","Shebeen Brewing Company <br/> Wolcott <br>  CT <br>","Back East Brewing Company <br/> Bloomfield <br>  CT <br>","Half Full Brewery <br/> Stamford <br>  CT <br>","New England Brewing Company <br/> Woodbridge <br>  CT <br>","Two Roads Brewing Company <br/> Stratford <br>  CT <br>","Cottrell Brewing <br/> Pawcatuck <br>  CT <br>","DC Brau Brewing Company <br/> Washington <br>  DC <br>","Iron Hill Brewery & Restaurant <br/> Wilmington <br>  DE <br>","Twin Lakes Brewing Company <br/> Greenville <br>  DE <br>","3 Daughters Brewing <br/> St Petersburg <br>  FL <br>","Cigar City Brewing Company <br/> Tampa <br>  FL <br>","Big Storm Brewing Company <br/> Odessa <br>  FL <br>","Two Henrys Brewing Company <br/> Plant City <br>  FL <br>","Brew Bus Brewing <br/> Tampa <br>  FL <br>","Due South Brewing Company <br/> Boynton Beach <br>  FL <br>","7venth Sun <br/> Dunedin <br>  FL <br>","Bold City Brewery <br/> Jacksonville <br>  FL <br>","Miami Brewing Company <br/> Miami <br>  FL <br>","Swamp Head Brewery <br/> Gainesville <br>  FL <br>","Engine 15 Brewing <br/> Jacksonville Beach <br>  FL <br>","Green Room Brewing <br/> Jacksonville <br>  FL <br>","Brindle Dog Brewing Company <br/> Tampa Bay <br>  FL <br>","Tampa Bay Brewing Company <br/> Tampa <br>  FL <br>","Intuition Ale Works <br/> Jacksonville <br>  FL <br>","SweetWater Brewing Company <br/> Atlanta <br>  GA <br>","Orpheus Brewing <br/> Atlanta <br>  GA <br>","Creature Comforts <br/> Athens <br>  GA <br>","Macon Beer Company <br/> Macon <br>  GA <br>","Coastal Empire Beer Company <br/> Savannah <br>  GA <br>","Terrapin Brewing Company <br/> Athens <br>  GA <br>","Red Hare Brewing Company <br/> Marietta <br>  GA <br>","Mehana Brewing Co. <br/> Hilo <br>  HI <br>","Hawai'i Nui Brewing Co. <br/> Hilo <br>  HI <br>","Maui Brewing Company <br/> Lahaina <br>  HI <br>","Kona Brewing Company <br/> Kona <br>  HI <br>","Kalona Brewing Company <br/> Kalona <br>  IA <br>","Great River Brewery <br/> Davenport <br>  IA <br>","Peace Tree Brewing Company <br/> Knoxville <br>  IA <br>","Okoboji Brewing Company <br/> Spirit Lake <br>  IA <br>","Confluence Brewing Company <br/> Des Moines <br>  IA <br>","Crooked Fence Brewing Company <br/> Garden City <br>  ID <br>","Laughing Dog Brewing Company <br/> Ponderay <br>  ID <br>","Payette Brewing Company <br/> Garden City <br>  ID <br>","Sockeye Brewing Company <br/> Boise <br>  ID <br>","Slanted Rock Brewing Company <br/> Meridian <br>  ID <br>","Big Muddy Brewing <br/> Murphysboro <br>  IL <br>","Revolution Brewing Company <br/> Chicago <br>  IL <br>","Pipeworks Brewing Company <br/> Chicago <br>  IL <br>","Flesk Brewing Company <br/> Lombard <br>  IL <br>","Pollyanna Brewing Company <br/> Lemont <br>  IL <br>","BuckleDown Brewing <br/> Lyons <br>  IL <br>","Destihl Brewery <br/> Bloomington <br>  IL <br>","SlapShot Brewing Company <br/> Chicago <br>  IL <br>","Mikerphone Brewing <br/> Chicago <br>  IL <br>","Two Brothers Brewing Company <br/> Warrenville <br>  IL <br>","Goose Island Brewing Company <br/> Chicago <br>  IL <br>","Spiteful Brewing Company <br/> Chicago <br>  IL <br>","Goose Island Brewery Company <br/> Chicago <br>  IL <br>","Temperance Beer Company <br/> Evanston <br>  IL <br>","Finch's Beer Company <br/> Chicago <br>  IL <br>","Half Acre Beer Company <br/> Chicago <br>  IL <br>","Wild Onion Brewing Company <br/> Lake Barrington <br>  IL <br>","Mickey Finn's Brewery <br/> Libertyville <br>  IL <br>","Flat 12 Bierwerks <br/> Indianapolis <br>  IN <br>","Tin Man Brewing Company <br/> Evansville <br>  IN <br>","Black Acre Brewing Co. <br/> Indianapolis <br>  IN <br>","Brew Link Brewing <br/> Plainfield <br>  IN <br>","Bare Hands Brewery <br/> Granger <br>  IN <br>","Three Pints Brewing <br/> Martinsville <br>  IN <br>","Four Fathers Brewing  <br/> Valparaiso <br>  IN <br>","Indiana City Brewing <br/> Indianapolis <br>  IN <br>","Burn 'Em Brewing <br/> Michigan City <br>  IN <br>","Sun King Brewing Company <br/> Indianapolis <br>  IN <br>","Evil Czech Brewery <br/> Mishawaka <br>  IN <br>","450 North Brewing Company <br/> Columbus <br>  IN <br>","Taxman Brewing Company <br/> Bargersville <br>  IN <br>","Great Crescent Brewery <br/> Aurora <br>  IN <br>","18th Street Brewery <br/> Gary <br>  IN <br>","Upland Brewing Company <br/> Bloomington <br>  IN <br>","People's Brewing Company <br/> Lafayette <br>  IN <br>","Chapman's Brewing <br/> Angola <br>  IN <br>","Cutters Brewing Company <br/> Avon <br>  IN <br>","Four Horsemen Brewing Company <br/> South Bend <br>  IN <br>","Daredevil Brewing Company <br/> Shelbyville <br>  IN <br>","Warbird Brewing Company <br/> Fort Wayne <br>  IN <br>","Tallgrass Brewing Company <br/> Manhattan <br>  KS <br>","Defiance Brewing Company <br/> Hays <br>  KS <br>","High Noon Saloon And Brewery <br/> Leavenworth <br>  KS <br>","Against the Grain Brewery <br/> Louisville <br>  KY <br>","Against The Grain Brewery <br/> Louisville <br>  KY <br>","West Sixth Brewing <br/> Lexington <br>  KY <br>","Alltech's Lexington Brewing Company <br/> Lexington <br>  KY <br>","Tin Roof Brewing Company <br/> Baton Rouge <br>  LA <br>","New Orleans Lager & Ale Brewing ... <br/> New Orleans <br>  LA <br>","Great Raft Brewing Company <br/> Shreveport <br>  LA <br>","Abita Brewing Company <br/> Abita Springs <br>  LA <br>","Covington Brewhouse <br/> Covington <br>  LA <br>","Jack's Abby Craft Lagers <br/> Framingham <br>  MA <br>","Blackrocks Brewery <br/> Marquette <br>  MA <br>","Beer Works Brewery <br/> Lowell <br>  MA <br>","Ipswich Ale Brewery <br/> Ipswich <br>  MA <br>","Cisco Brewers <br/> Nantucket <br>  MA <br>","Cambridge Brewing Company <br/> Cambridge <br>  MA <br>","Cape Ann Brewing Company <br/> Gloucester <br>  MA <br>","Harpoon Brewery <br/> Boston <br>  MA <br>","Cape Cod Beer <br/> Hyannis <br>  MA <br>","Notch Brewing Company <br/> Ipswich <br>  MA <br>","Berkshire Brewing Company <br/> South Deerfield <br>  MA <br>","Northampton Brewery <br/> Northamtpon <br>  MA <br>","Wachusett Brewing Company <br/> Westminster <br>  MA <br>","Boston Beer Company <br/> Boston <br>  MA <br>","Blue Hills Brewery <br/> Canton <br>  MA <br>","Night Shift Brewing <br/> Everett <br>  MA <br>","Banner Beer Company <br/> Williamsburg <br>  MA <br>","Wormtown Brewery <br/> Worcester <br>  MA <br>","Westfield River Brewing Company <br/> Westfield <br>  MA <br>","Downeast Cider House <br/> Leominster <br>  MA <br>","Big Elm Brewing <br/> Sheffield <br>  MA <br>","Newburyport Brewing Company <br/> Newburyport <br>  MA <br>","Sherwood Forest Brewers <br/> Marlborough <br>  MA <br>","Red Shedman Farm Brewery and Hop... <br/> Mt. Airy <br>  MD <br>","Union Craft Brewing <br/> Baltimore <br>  MD <br>","Jailbreak Brewing Company <br/> Laurel <br>  MD <br>","Stillwater Artisanal Ales <br/> Baltimore <br>  MD <br>","The Brewer's Art <br/> Baltimore <br>  MD <br>","Heavy Seas Beer <br/> Halethorpe <br>  MD <br>","Flying Dog Brewery <br/> Frederick <br>  MD <br>","Rising Tide Brewing Company <br/> Portland <br>  ME <br>","Glabrous Brewing Company <br/> Pineland <br>  ME <br>","Peak Organic Brewing Company <br/> Portland <br>  ME <br>","Baxter Brewing Company <br/> Lewiston <br>  ME <br>","Marshall Wharf Brewing Company <br/> Belfast <br>  ME <br>","D.L. Geary Brewing Company <br/> Portland <br>  ME <br>","Shipyard Brewing Company <br/> Portland <br>  ME <br>","Stone Coast Brewing Company <br/> Portland <br>  ME <br>","Sea Dog Brewing Company <br/> Portland <br>  ME <br>","Tapistry Brewing <br/> Bridgman <br>  MI <br>","Big Lake Brewing <br/> Holland <br>  MI <br>","The Mitten Brewing Company <br/> Grand Rapids <br>  MI <br>","Brewery Vivant <br/> Grand Rapids <br>  MI <br>","Petoskey Brewing <br/> Petoskey <br>  MI <br>","Blackrocks Brewery <br/> Marquette <br>  MI <br>","Perrin Brewing Company <br/> Comstock Park <br>  MI <br>","Witch's Hat Brewing Company <br/> South Lyon <br>  MI <br>","Founders Brewing Company <br/> Grand Rapids <br>  MI <br>","Gonzo's BiggDogg Brewing <br/> Kalamazoo <br>  MI <br>","Latitude 42 Brewing Company <br/> Portage <br>  MI <br>","Atwater Brewery <br/> Detroit <br>  MI <br>","Bell's Brewery <br/> Kalamazoo <br>  MI <br>","Keweenaw Brewing Company <br/> Houghton <br>  MI <br>","Brewery Terra Firma <br/> Traverse City <br>  MI <br>","Cheboygan Brewing Company <br/> Cheboygan <br>  MI <br>","Griffin Claw Brewing Company <br/> Birmingham <br>  MI <br>","Sietsema Orchards and Cider Mill <br/> Ada <br>  MI <br>","Right Brain Brewery <br/> Traverse City <br>  MI <br>","Vander Mill Ciders <br/> Spring Lake <br>  MI <br>","St. Julian Winery <br/> Paw Paw <br>  MI <br>","Rochester Mills Brewing Company <br/> Rochester <br>  MI <br>","Frankenmuth Brewery <br/> Frankenmuth <br>  MI <br>","Meckley's Cidery <br/> Somerset Center <br>  MI <br>","Mountain Town Brewing Company  <br/> Mount Pleasant <br>  MI <br>","Uncle John's Fruit House Winery <br/> St. John's <br>  MI <br>","White Flame Brewing Company <br/> Hudsonville <br>  MI <br>","Saugatuck Brewing Company <br/> Douglas <br>  MI <br>","Wolverine State Brewing Company <br/> Ann Arbor <br>  MI <br>","The Right Brain Brewery <br/> Traverse City <br>  MI <br>","MillKing It Productions <br/> Royal Oak <br>  MI <br>","Arcadia Brewing Company <br/> Battle Creek <br>  MI <br>","NorthGate Brewing  <br/> Minneapolis <br>  MN <br>","Bent Brewstillery <br/> Roseville <br>  MN <br>","Summit Brewing Company <br/> St. Paul <br>  MN <br>","Surly Brewing Company <br/> Brooklyn Center <br>  MN <br>","Bent Paddle Brewing Company <br/> Duluth <br>  MN <br>","Summit Brewing Company <br/> St Paul <br>  MN <br>","Third Street Brewhouse <br/> Cold Spring <br>  MN <br>","Lift Bridge Brewing Company <br/> Stillwater <br>  MN <br>","Bauhaus Brew Labs <br/> Minneapolis <br>  MN <br>","Indeed Brewing Company <br/> Minneapolis <br>  MN <br>","Big Wood Brewery <br/> Vadnais Heights <br>  MN <br>","Tonka Beer Company <br/> Minnetonka <br>  MN <br>","Boulevard Brewing Company <br/> Kansas City <br>  MO <br>","4 Hands Brewing Company <br/> Saint Louis <br>  MO <br>","Kirkwood Station Brewing Company <br/> Kirkwood <br>  MO <br>","Weston Brewing Company <br/> Weston <br>  MO <br>","Mother's Brewing <br/> Springfield <br>  MO <br>","Piney River Brewing Company <br/> Bucryus <br>  MO <br>","Morgan Street Brewery <br/> Saint Louis <br>  MO <br>","Schlafly Brewing Company <br/> Saint Louis <br>  MO <br>","O'Fallon Brewery <br/> O'Fallon <br>  MO <br>","Southern Prohibition Brewing Com... <br/> Hattiesburg <br>  MS <br>","Lucky Town Brewing Company <br/> Jackson <br>  MS <br>","Bozeman Brewing Company <br/> Bozeman <br>  MT <br>","Big Sky Brewing Company <br/> Missoula <br>  MT <br>","Bitter Root Brewing <br/> Hamilton <br>  MT <br>","Tamarack Brewing Company <br/> Lakeside <br>  MT <br>","Wildwood Brewing Company <br/> Stevensville <br>  MT <br>","Kettle House Brewing Company <br/> Missoula <br>  MT <br>","Harvest Moon Brewing Company <br/> Belt <br>  MT <br>","Lewis and Clark Brewing Company <br/> Helena <br>  MT <br>","Great Northern Brewing Company <br/> Whitefish <br>  MT <br>","Appalachian Mountain Brewery <br/> Boone <br>  NC <br>","Birdsong Brewing Company <br/> Charlotte <br>  NC <br>","Catawba Valley Brewing Company <br/> Morganton <br>  NC <br>","Lonerider Brewing Company <br/> Raleigh <br>  NC <br>","Carolina Brewery <br/> Pittsboro <br>  NC <br>","Frog Level Brewing Company <br/> Waynesville <br>  NC <br>","Pisgah Brewing Company <br/> Black Mountain <br>  NC <br>","Catawba Brewing Company <br/> Morganton <br>  NC <br>","Fullsteam Brewery <br/> Durham <br>  NC <br>","NoDa Brewing Company <br/> Charlotte <br>  NC <br>","Aviator Brewing Company <br/> Fuquay-Varina <br>  NC <br>","Oskar Blues Brewery (North Carol... <br/> Brevard <br>  NC <br>","French Broad Brewery <br/> Asheville <br>  NC <br>","Howard Brewing Company <br/> Lenoir <br>  NC <br>","Cans Bar and Canteen <br/> Charlotte <br>  NC <br>","Carolina Beer & Beverage <br/> Mooresville <br>  NC <br>","Triangle Brewing Company <br/> Durham <br>  NC <br>","Asheville Brewing Company <br/> Asheville <br>  NC <br>","Mother Earth Brewing Company <br/> Kinston <br>  NC <br>","Fargo Brewing Company <br/> Fargo <br>  ND <br>","Modern Monks Brewery <br/> Lincoln <br>  NE <br>","Thunderhead Brewing Company <br/> Kearney <br>  NE <br>","Nebraska Brewing Company <br/> Papillion <br>  NE <br>","Blue Blood Brewing Company <br/> Lincoln <br>  NE <br>","Spilker Ales <br/> Cortland <br>  NE <br>","White Birch Brewing <br/> Hooksett <br>  NH <br>","Woodstock Inn, Station & Brewery <br/> North Woodstock <br>  NH <br>","Moat Mountain Smoke House & Brew... <br/> North Conway <br>  NH <br>","Forgotten Boardwalk <br/> Cherry Hill <br>  NJ <br>","Carton Brewing Company <br/> Atlantic Highlands <br>  NJ <br>","Bolero Snort Brewery <br/> Ridgefield Park <br>  NJ <br>","Tractor Brewing Company <br/> Albuquerque <br>  NM <br>","La Cumbre Brewing Company <br/> Albuquerque <br>  NM <br>","Santa Fe Brewing Company <br/> Santa Fe <br>  NM <br>","Marble Brewery <br/> Albuquerque <br>  NM <br>","Joseph James Brewing Company <br/> Henderson <br>  NV <br>","Buckbean Brewing Company <br/> Reno <br>  NV <br>","Sixpoint Craft Ales <br/> Brooklyn <br>  NY <br>","Evil Twin Brewing <br/> Brooklyn <br>  NY <br>","Chatham Brewing <br/> Chatham <br>  NY <br>","Newburgh Brewing Company <br/> Newburgh <br>  NY <br>","Southampton Publick House <br/> Southampton <br>  NY <br>","Montauk Brewing Company <br/> Montauk <br>  NY <br>","Matt Brewing Company <br/> Utica <br>  NY <br>","The Bronx Brewery <br/> Bronx <br>  NY <br>","KelSo Beer Company <br/> Brooklyn <br>  NY <br>","Brooklyn Brewery <br/> Brooklyn <br>  NY <br>","The Manhattan Brewing Company <br/> New York <br>  NY <br>","Blue Point Brewing Company <br/> Patchogue <br>  NY <br>","Bomb Beer Company <br/> New York <br>  NY <br>","Dundee Brewing Company <br/> Rochester <br>  NY <br>","Upstate Brewing Company <br/> Elmira <br>  NY <br>","Butternuts Beer and Ale <br/> Garrattsville <br>  NY <br>","Madtree Brewing Company <br/> Cincinnati <br>  OH <br>","Jackie O's Pub & Brewery <br/> Athens <br>  OH <br>","Rhinegeist Brewery <br/> Cincinnati <br>  OH <br>","Warped Wing Brewing Company <br/> Dayton <br>  OH <br>","Christian Moerlein Brewing Company <br/> Cincinnati <br>  OH <br>","Four String Brewing Company <br/> Columbus <br>  OH <br>","Platform Beer Company <br/> Cleveland <br>  OH <br>","Seventh Son Brewing Company <br/> Columbus <br>  OH <br>","Fat Head's Brewery <br/> Middleburg Heights <br>  OH <br>","Portside Brewery <br/> Cleveland <br>  OH <br>","Catawba Island Brewing <br/> Port Clinton <br>  OH <br>","Rivertown Brewing Company <br/> Lockland <br>  OH <br>","Elevator Brewing Company <br/> Columbus <br>  OH <br>","Buckeye Brewing <br/> Cleveland <br>  OH <br>","Angry Orchard Cider Company <br/> Cincinnati <br>  OH <br>","COOP Ale Works <br/> Oklahoma City <br>  OK <br>","Anthem Brewing Company <br/> Oklahoma City <br>  OK <br>","Dead Armadillo Craft Brewing <br/> Tulsa <br>  OK <br>","Mustang Brewing Company <br/> Mustang <br>  OK <br>","RoughTail Brewing Company <br/> Midwest City <br>  OK <br>","Krebs Brewing Company (Pete's Pl... <br/> Krebs <br>  OK <br>","Hopworks Urban Brewery <br/> Portland <br>  OR <br>","Base Camp Brewing Co. <br/> Portland <br>  OR <br>","Alameda Brewing <br/> Portland <br>  OR <br>","Oakshire Brewing <br/> Eugene <br>  OR <br>","Three Creeks Brewing <br/> Sisters <br>  OR <br>","2 Towns Ciderhouse <br/> Corvallis <br>  OR <br>","Caldera Brewing Company <br/> Ashland <br>  OR <br>","Goodlife Brewing Co. <br/> Bend <br>  OR <br>","Breakside Brewery <br/> Portland <br>  OR <br>","Burnside Brewing Co. <br/> Portland <br>  OR <br>","Hop Valley Brewing Company <br/> Springfield <br>  OR <br>","Worthy Brewing Company <br/> Bend <br>  OR <br>","Occidental Brewing Company <br/> Portland <br>  OR <br>","Fearless Brewing Company <br/> Estacada <br>  OR <br>","Fort George Brewery <br/> Astoria <br>  OR <br>","Rogue Ales <br/> Newport <br>  OR <br>","Widmer Brothers Brewing Company <br/> Portland <br>  OR <br>","Astoria Brewing Company <br/> Astoria <br>  OR <br>","Natian Brewery <br/> Portland <br>  OR <br>","Red Tank Cider Company <br/> Bend <br>  OR <br>","Cascadia Ciderworks United <br/> Portland <br>  OR <br>","10 Barrel Brewing Company <br/> Bend <br>  OR <br>","Coalition Brewing Company <br/> Portland <br>  OR <br>","Blue Dog Mead <br/> Eugene <br>  OR <br>","Southern Oregon Brewing Company <br/> Medford <br>  OR <br>","Deschutes Brewery <br/> Bend <br>  OR <br>","Good Life Brewing Company <br/> Bend <br>  OR <br>","MacTarnahans Brewing Company <br/> Portland <br>  OR <br>","Seven Brides Brewery <br/> Silverton <br>  OR <br>","Rivertowne Brewing Company <br/> Export <br>  PA <br>","The Lion Brewery <br/> Wilkes-Barre <br>  PA <br>","TrÃ¶egs Brewing Company <br/> Hershey <br>  PA <br>","Vault Brewing Company <br/> Yardley <br>  PA <br>","Straub Brewery <br/> St Mary's <br>  PA <br>","Fort Pitt Brewing Company <br/> Latrobe <br>  PA <br>","Sly Fox Brewing Company <br/> Phoenixville <br>  PA <br>","Round Guys Brewing <br/> Lansdale <br>  PA <br>","Boxcar Brewing Company <br/> West Chester <br>  PA <br>","Hop Farm Brewing Company <br/> Pittsburgh <br>  PA <br>","Liquid Hero Brewery <br/> York <br>  PA <br>","Old Forge Brewing Company <br/> Danville <br>  PA <br>","Voodoo Brewery <br/> Meadville <br>  PA <br>","Neshaminy Creek Brewing Company <br/> Croydon <br>  PA <br>","Lavery Brewing Company <br/> Erie <br>  PA <br>","Manayunk Brewing Company <br/> Philadelphia <br>  PA <br>","Mikkeller <br/> Pottstown <br>  PA <br>","Sly Fox Brewing Company <br/> Pottstown <br>  PA <br>","Spring House Brewing Company <br/> Conestoga <br>  PA <br>","Swashbuckler Brewing Company <br/> Manheim <br>  PA <br>","Jack's Hard Cider (Hauser Estate... <br/> Biglerville <br>  PA <br>","North Country Brewing Company <br/> Slippery Rock <br>  PA <br>","Dock Street Brewery <br/> Philadelphia <br>  PA <br>","Flat Rock Brewing Company <br/> Smithton <br>  PA <br>","Lancaster Brewing Company <br/> Lancaster <br>  PA <br>","Grey Sail Brewing Company <br/> Westerly <br>  RI <br>","Coastal Extreme Brewing Company <br/> Newport <br>  RI <br>","Narragansett Brewing Company <br/> Providence <br>  RI <br>","Foolproof Brewing Company <br/> Pawtucket <br>  RI <br>","Grey Sail Brewing of Rhode Island <br/> Westerly <br>  RI <br>","COAST Brewing Company <br/> Charleston <br>  SC <br>","Quest Brewing Company <br/> Greenville <br>  SC <br>","Westbrook Brewing Company <br/> Mt. Pleasant <br>  SC <br>","New South Brewing Company <br/> Myrtle Beach <br>  SC <br>","Crow Peak Brewing Company <br/> Spearfish <br>  SD <br>","Wiseacre Brewing Company <br/> Memphis <br>  TN <br>","Jackalope Brewing Company <br/> Nashville <br>  TN <br>","Big River Brewing Company <br/> Chattanooga <br>  TN <br>","Cedar Creek Brewery <br/> Seven Points <br>  TX <br>","Twisted X Brewing Company <br/> Dripping Springs <br>  TX <br>","Freetail Brewing Company <br/> San Antonio <br>  TX <br>","Blue Owl Brewing <br/> Austin <br>  TX <br>","Southern Star Brewing Company <br/> Conroe <br>  TX <br>","Karbach Brewing Company <br/> Houston <br>  TX <br>","Uncle Billy's Brewery and Smokeh... <br/> Austin <br>  TX <br>","Deep Ellum Brewing Company <br/> Dallas <br>  TX <br>","Real Ale Brewing Company <br/> Blanco <br>  TX <br>","Hops & Grains Brewing Company <br/> Austin <br>  TX <br>","Independence Brewing Company <br/> Austin <br>  TX <br>","Martin House Brewing Company <br/> Fort Worth <br>  TX <br>","Rahr & Sons Brewing Company <br/> Fort Worth <br>  TX <br>","Oasis Texas Brewing Company <br/> Austin <br>  TX <br>","Pedernales Brewing Company <br/> Fredericksburg <br>  TX <br>","Branchline Brewing Company <br/> San Antonio <br>  TX <br>","Grapevine Craft Brewery <br/> Farmers Branch <br>  TX <br>","Buffalo Bayou Brewing Company <br/> Houston <br>  TX <br>","Texian Brewing Co. <br/> Richmond <br>  TX <br>","New Republic Brewing Company <br/> College Station <br>  TX <br>","Infamous Brewing Company <br/> Austin <br>  TX <br>","South Austin Brewery <br/> South Austin <br>  TX <br>","Four Corners Brewing Company <br/> Dallas <br>  TX <br>","Hops & Grain Brewery <br/> Austin <br>  TX <br>","Austin Beerworks <br/> Austin <br>  TX <br>","Armadillo Ale Works <br/> Denton <br>  TX <br>","Big Bend Brewing Company <br/> Alpine <br>  TX <br>","Pete's Brewing Company <br/> San Antonio <br>  TX <br>","Uinta Brewing Company <br/> Salt Lake City <br>  UT <br>","Utah Brewers Cooperative <br/> Salt Lake City <br>  UT <br>","Bohemian Brewery <br/> Midvale <br>  UT <br>","Moab Brewery <br/> Moab <br>  UT <br>","Flying Mouse Brewery <br/> Troutville <br>  VA <br>","Smartmouth Brewing Company <br/> Norfolk <br>  VA <br>","Center of the Universe Brewing C... <br/> Ashland <br>  VA <br>","Wild Wolf Brewing Company <br/> Nellysford <br>  VA <br>","Champion Brewing Company <br/> Charlottesville <br>  VA <br>","Devil's Backbone Brewing Company <br/> Lexington <br>  VA <br>","Three Notch'd Brewing Company <br/> Charlottesville <br>  VA <br>","Beach Brewing Company <br/> Virginia Beach <br>  VA <br>","Hardywood Park Craft Brewery <br/> Richmond <br>  VA <br>","Wolf Hills Brewing Company <br/> Abingdon <br>  VA <br>","Blue Mountain Brewery <br/> Afton <br>  VA <br>","Starr Hill Brewery <br/> Crozet <br>  VA <br>","Blue Mountain Brewery <br/> Arrington <br>  VA <br>","Roanoke Railhouse Brewery <br/> Roanoke <br>  VA <br>","Lost Rhino Brewing Company <br/> Ashburn <br>  VA <br>","Sunken City Brewing Company <br/> Hardy <br>  VA <br>","Lost Nation Brewing <br/> East Fairfield <br>  VT <br>","Fiddlehead Brewing Company <br/> Shelburne <br>  VT <br>","Otter Creek Brewing <br/> Waterbury <br>  VT <br>","Long Trail Brewing Company <br/> Bridgewater Corners <br>  VT <br>","The Alchemist <br/> Waterbury <br>  VT <br>","Otter Creek Brewing <br/> Middlebury <br>  VT <br>","Magic Hat Brewing Company <br/> South Burlington <br>  VT <br>","The Just Beer Project <br/> Burlington <br>  VT <br>","The Traveler Beer Company <br/> Burlington <br>  VT <br>","Woodchuck Hard Cider <br/> Middlebury <br>  VT <br>","Everybody's Brewing <br/> White Salmon <br>  WA <br>","Two Beers Brewing Company <br/> Seattle <br>  WA <br>","Hale's Ales <br/> Seattle <br>  WA <br>","Dirty Bucket Brewing Company <br/> Woodinville <br>  WA <br>","Dick's Brewing Company <br/> Centralia <br>  WA <br>","Aslan Brewing Company <br/> Bellingham <br>  WA <br>","Kulshan Brewery <br/> Bellingham <br>  WA <br>","Hilliard's Beer <br/> Seattle <br>  WA <br>","Airways Brewing Company <br/> Kent <br>  WA <br>","Orlison Brewing Company <br/> Airway Heights <br>  WA <br>","Schilling & Company <br/> Seattle <br>  WA <br>","Amnesia Brewing Company <br/> Washougal <br>  WA <br>","Seattle Cider Company <br/> Seattle <br>  WA <br>","Northwest Brewing Company <br/> Pacific <br>  WA <br>","Fremont Brewing Company <br/> Seattle <br>  WA <br>","Engine House 9 <br/> Tacoma <br>  WA <br>","7 Seas Brewing Company <br/> Gig Harbor <br>  WA <br>","Bale Breaker Brewing Company <br/> Yakima <br>  WA <br>","Redhook Brewery <br/> Woodinville <br>  WA <br>","Wingman Brewers <br/> Tacoma <br>  WA <br>","Emerald City Beer Company <br/> Seattle <br>  WA <br>","Churchkey Can Company <br/> Seattle <br>  WA <br>","Pyramid Breweries <br/> Seattle <br>  WA <br>","James Page Brewing Company <br/> Stevens Point <br>  WI <br>","Ale Asylum <br/> Madison <br>  WI <br>","Horny Goat Brew Pub <br/> Milwaukee <br>  WI <br>","Stevens Point Brewery <br/> Stevens Point <br>  WI <br>","Minhas Craft Brewery <br/> Monroe <br>  WI <br>","Angry Minnow <br/> Hayward <br>  WI <br>","Capital Brewery <br/> Middleton <br>  WI <br>","Wisconsin Brewing Company <br/> Verona <br>  WI <br>","Geneva Lake Brewing Company <br/> Lake Geneva <br>  WI <br>","Milwaukee Brewing Company <br/> Milwaukee <br>  WI <br>","Hinterland Brewery <br/> Green Bay <br>  WI <br>","Lucette Brewing Company <br/> Menominee <br>  WI <br>","Lazy Monk Brewing <br/> Eau Claire <br>  WI <br>","Ciderboys <br/> Stevens Point <br>  WI <br>","Lucette Brewing Company <br/> Menominie <br>  WI <br>","Stillmank Beer Company <br/> Green Bay <br>  WI <br>","Sprecher Brewing Company <br/> Glendale <br>  WI <br>","Northwoods Brewpub <br/> Eau Claire <br>  WI <br>","Angry Minnow Brewing Company <br/> Hayward <br>  WI <br>","Dave's Brewfarm <br/> Wilson <br>  WI <br>","Greenbrier Valley Brewing Company <br/> Lewisburg <br>  WV <br>","Black Tooth Brewing Company <br/> Sheridan <br>  WY <br>","Snake River Brewing Company <br/> Jackson <br>  WY <br>","The Black Tooth Brewing Company <br/> Sheridan <br>  WY <br>","Wind River Brewing Company <br/> Pinedale <br>  WY <br>"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[20.46,61.3025006],"lng":[-158.7750198,-69.0148656]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># End prepare an interactive geo map of breweries by state#

# Corresponding distribution plot of breweries by state
ggplot(brewery_map, aes(x=as.factor(State), color=&quot;blue&quot;)) +
  geom_bar(color=&quot;blue&quot;) +
  ggtitle(&quot;Distribution of Breweries by State&quot;) +
  xlab(&quot;State&quot;) +
  geom_text(stat=&#39;count&#39;, aes(label=after_stat(count)), vjust=-.25) +
  theme(legend.position=&quot;none&quot;,
        axis.text.x = element_text(angle = 90))+
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-4-3.png" width="768" /></p>
<pre class="r"><code># Corresponding distribution plot of breweries by region
ggplot(brewery_map, aes(x=as.factor(Region), color=&quot;green&quot;)) +
  geom_bar(color=&quot;green&quot;) +
  ggtitle(&quot;Distribution of Breweries by Region&quot;) +
  xlab(&quot;Region&quot;) +
  geom_text(stat=&#39;count&#39;, aes(label=after_stat(count)), vjust=-.25) +
  theme(legend.position=&quot;none&quot;,
        axis.text.x = element_text(angle = 90)) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-4-4.png" width="768" /> # Begin-Exploratory Data Analysis #</p>
<pre class="r"><code>## Examine the datasets
head(beer, 5)</code></pre>
<pre><code>##                  Name Beer_ID   ABV IBU Brewery_id                    Style
## 1        Loki Red Ale    2191 0.075  53        202 American Amber / Red Ale
## 2         Devil&#39;s Cup    2265 0.066  NA        178  American Pale Ale (APA)
## 3        Black Exodus    2261 0.077  NA        178            Oatmeal Stout
## 4 Lake Street Express    2260 0.045  NA        178  American Pale Ale (APA)
## 5             Foreman    2259 0.065  NA        178          American Porter
##   Ounces Type
## 1     16  ALE
## 2     12  ALE
## 3     12  ALE
## 4     12  ALE
## 5     12  ALE</code></pre>
<pre class="r"><code>head(brewery, 5)</code></pre>
<pre><code>##   Brew_ID                         Name      City State Latitude Longitude
## 1     103  King Street Brewing Company Anchorage    AK  61.3025  -158.775
## 2     224 Midnight Sun Brewing Company Anchorage    AK  61.3025  -158.775
## 3     271      Alaskan Brewing Company    Juneau    AK  61.3025  -158.775
## 4     454       Denali Brewing Company Talkeetna    AK  61.3025  -158.775
## 5     459  Kenai River Brewing Company  Soldotna    AK  61.3025  -158.775
##      Region
## 1 Southeast
## 2 Southeast
## 3 Southeast
## 4 Southeast
## 5 Southeast</code></pre>
<pre class="r"><code>## Merge the datasets
merge_bb &lt;- merge(beer, brewery, by.x=&quot;Brewery_id&quot;, by.y=&quot;Brew_ID&quot;)

head(merge_bb, 5)</code></pre>
<pre><code>##   Brewery_id        Name.x Beer_ID   ABV IBU              Style Ounces Type
## 1          1  Get Together    2692 0.045  50       American IPA     16  IPA
## 2          1    Wall&#39;s End    2690 0.048  19  English Brown Ale     16  ALE
## 3          1    Stronghold    2688 0.060  25    American Porter     16  ALE
## 4          1 Maggie&#39;s Leap    2691 0.049  26 Milk / Sweet Stout     16  ALE
## 5          1       Pumpion    2689 0.060  38        Pumpkin Ale     16  ALE
##               Name.y        City State Latitude Longitude  Region
## 1 NorthGate Brewing  Minneapolis    MN 46.44186 -93.36551 Midwest
## 2 NorthGate Brewing  Minneapolis    MN 46.44186 -93.36551 Midwest
## 3 NorthGate Brewing  Minneapolis    MN 46.44186 -93.36551 Midwest
## 4 NorthGate Brewing  Minneapolis    MN 46.44186 -93.36551 Midwest
## 5 NorthGate Brewing  Minneapolis    MN 46.44186 -93.36551 Midwest</code></pre>
<pre class="r"><code>## Drop latitude and longitude columns as no longer needed
drop &lt;- c(&quot;Latitude&quot;,&quot;Longitude&quot;)
df = merge_bb[,!(names(merge_bb) %in% drop)]

names(df)</code></pre>
<pre><code>##  [1] &quot;Brewery_id&quot; &quot;Name.x&quot;     &quot;Beer_ID&quot;    &quot;ABV&quot;        &quot;IBU&quot;       
##  [6] &quot;Style&quot;      &quot;Ounces&quot;     &quot;Type&quot;       &quot;Name.y&quot;     &quot;City&quot;      
## [11] &quot;State&quot;      &quot;Region&quot;</code></pre>
<pre class="r"><code>## Rename columns to avoid confusion
df &lt;- df %&gt;% 
  rename(
    Beer = Name.x,
    Brewery = Name.y
  )
str(df)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1683 obs. of  12 variables:
##  $ Brewery_id: num  1 1 1 1 1 2 2 2 2 2 ...
##  $ Beer      : chr  &quot;Get Together&quot; &quot;Wall&#39;s End&quot; &quot;Stronghold&quot; &quot;Maggie&#39;s Leap&quot; ...
##  $ Beer_ID   : num  2692 2690 2688 2691 2689 ...
##  $ ABV       : num  0.045 0.048 0.06 0.049 0.06 0.042 0.08 0.077 0.065 0.066 ...
##  $ IBU       : num  50 19 25 26 38 42 68 25 NA 21 ...
##  $ Style     : chr  &quot;American IPA&quot; &quot;English Brown Ale&quot; &quot;American Porter&quot; &quot;Milk / Sweet Stout&quot; ...
##  $ Ounces    : num  16 16 16 16 16 16 16 16 16 16 ...
##  $ Type      : chr  &quot;IPA&quot; &quot;ALE&quot; &quot;ALE&quot; &quot;ALE&quot; ...
##  $ Brewery   : chr  &quot;NorthGate Brewing &quot; &quot;NorthGate Brewing &quot; &quot;NorthGate Brewing &quot; &quot;NorthGate Brewing &quot; ...
##  $ City      : chr  &quot;Minneapolis&quot; &quot;Minneapolis&quot; &quot;Minneapolis&quot; &quot;Minneapolis&quot; ...
##  $ State     : chr  &quot; MN&quot; &quot; MN&quot; &quot; MN&quot; &quot; MN&quot; ...
##  $ Region    : chr  &quot;Midwest&quot; &quot;Midwest&quot; &quot;Midwest&quot; &quot;Midwest&quot; ...</code></pre>
<pre class="r"><code>#Get count of breweries in each state
brewery_count &lt;- aggregate(Brewery_id ~ State, df, sum) #gives column name for count as Brewery_ID

#Rename the Brewery_id column to Total_Breweries
brewery_count &lt;- brewery_count %&gt;%
   rename(
     Total_Breweries = Brewery_id 
)</code></pre>
</div>
<div id="check-for-missing-values" class="section level2">
<h2>Check for missing values</h2>
<pre class="r"><code>library(naniar)
vis_miss(df)</code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<pre class="r"><code>#ABV, IBU and Style contain missing values - count
table(is.na(df$ABV))</code></pre>
<pre><code>## 
## FALSE  TRUE 
##  1635    48</code></pre>
<pre class="r"><code>table(is.na(df$IBU))</code></pre>
<pre><code>## 
## FALSE  TRUE 
##  1024   659</code></pre>
<pre class="r"><code>table(is.na(df$Type))</code></pre>
<pre><code>## 
## FALSE 
##  1683</code></pre>
<pre class="r"><code>table(is.na(df$Style))</code></pre>
<pre><code>## 
## FALSE 
##  1683</code></pre>
<pre class="r"><code>#view which beers do not have styles or types
df[is.na(df$Style),]</code></pre>
<pre><code>##  [1] Brewery_id Beer       Beer_ID    ABV        IBU        Style     
##  [7] Ounces     Type       Brewery    City       State      Region    
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<pre class="r"><code>df[is.na(df$Type),]</code></pre>
<pre><code>##  [1] Brewery_id Beer       Beer_ID    ABV        IBU        Style     
##  [7] Ounces     Type       Brewery    City       State      Region    
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<pre class="r"><code>#impute the rows with zeroes per Ryan
df$ABV[is.na(df$ABV)] &lt;- 0
df$IBU[is.na(df$IBU)] &lt;- 0

## How does this data relate to client Budweiser?
which(df$Brewery == &quot;Budweiser&quot;) </code></pre>
<pre><code>## integer(0)</code></pre>
<pre class="r"><code>grep(&quot;Clydesdales^&quot;,df$Brewery)</code></pre>
<pre><code>## integer(0)</code></pre>
<pre class="r"><code>drop &lt;- c(&quot;Region.y&quot;)
mergeABVIBU = merge_bb[,!(names(merge_bb) %in% drop)]

drop &lt;- c(&quot;Region.y&quot;, &quot;Style.y&quot;)
mergeABVIBU.Style = merge_bb[,!(names(merge_bb) %in% drop)]</code></pre>
</div>
</div>
<div id="visualize-abv-v-ibu-medians-by-state-and-by-region" class="section level1">
<h1>Visualize ABV v IBU medians by state and by region</h1>
<pre class="r"><code>options(scipen = 999)
mergeABVIBU &lt;- as.data.frame(mergeABVIBU)
mergeABVIBU.Style &lt;- as.data.frame(mergeABVIBU.Style)
#by state
ggplot(mergeABVIBU, aes(ABV, IBU)) +
  geom_point() +
  ggtitle(&quot;Median ABV v IBU by State&quot;) +
  facet_wrap(vars(State)) </code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
<pre class="r"><code>#by region
ggplot(mergeABVIBU, aes(ABV, IBU, color=Region)) +
  geom_point() +
  ggtitle(&quot;Median ABV v IBU by Region&quot;) +
  facet_wrap(vars(Region)) </code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-8-2.png" width="768" /></p>
<pre class="r"><code>#recheck for missing values
vis_miss(df)</code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-8-3.png" width="768" /> # Summary Statistics</p>
<pre class="r"><code>#load the mosaic package/library
library(mosaic)
#load the psych package/library
library(psych)

#5-number summary
favstats(df$ABV)</code></pre>
<pre><code>##  min    Q1 median    Q3  max       mean         sd    n missing
##    0 0.051  0.059 0.069 0.12 0.05992989 0.01664688 1683       0</code></pre>
<pre class="r"><code>favstats(df$IBU)</code></pre>
<pre><code>##  min Q1 median Q3 max     mean       sd    n missing
##    0  0     22 55 138 29.93286 31.43674 1683       0</code></pre>
<pre class="r"><code>par(mfrow=c(2,2)) #resets graphics device
#histograms for ABV and IBU
hist(df$ABV, labels = TRUE)
hist(df$IBU, labels = TRUE)</code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
<pre class="r"><code># Describe by Style or by Type
#describeBy(df, group=df$Style)
#describeBy(df,group=df$Type)
State_ABV &lt;- aggregate(x = df$ABV,              
                       by = list(df$State),    
                       FUN = median)

State_IBU &lt;- aggregate(x = df$IBU,              
                       by = list(df$State),    
                       FUN = median)
Style_ABV &lt;- aggregate(x = df$ABV,              
          by = list(df$Style),    
         FUN = median)

Style_IBU &lt;- aggregate(x = df$IBU,              
                       by = list(df$Style),    
                       FUN = median)
Type_ABV &lt;- aggregate(x = df$ABV,              
                      by = list(df$Type),    
                      FUN = median)
Type_IBU &lt;- aggregate(x = df$IBU,              
                      by = list(df$Type),    
                      FUN = median)
#correlation analysis
library(Hmisc)
cor(df$ABV, df$IBU)</code></pre>
<pre><code>## [1] 0.392111</code></pre>
<pre class="r"><code>#visualize correlations
library(GGally)
#Correlation plot of data
ggpairs(df, columns = 4:5, ggplot2::aes(colour=Type)) </code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-10-1.png" width="768" /></p>
<pre class="r"><code>## Visualize summaries
#plot of ABV by Style
qplot(mergeABVIBU.Style$Style, mergeABVIBU.Style$ABV, color=mergeABVIBU.Style$Region) +
  ggtitle(&quot;Median ABV by Style&quot;) +
  xlab(&quot;Style&quot;) +
  ylab(&#39;ABV&#39;) + labs(color=&#39;Region&#39;)  +
  theme(legend.position=&quot;top&quot;,
        axis.text.x = element_text(angle = 90, size=6)) +
  theme(legend.text=element_text(size=6)) +
  theme(plot.title = element_text(hjust = 0.5, size=12))</code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-10-2.png" width="768" /></p>
<pre class="r"><code>#plot of IBU by Style
qplot(mergeABVIBU.Style$Style, mergeABVIBU.Style$IBU, color=mergeABVIBU.Style$Region) +
  ggtitle(&quot;Median IBU by Style&quot;) +
  xlab(&quot;Style&quot;) +
  ylab(&#39;IBU&#39;) + labs(color=&#39;Region&#39;) +
  theme(legend.position=&quot;top&quot;,
        axis.text.x = element_text(angle = 90, size=6)) +
  theme(legend.text=element_text(size=6)) +
  theme(plot.title = element_text(hjust = 0.5, size=12))</code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-10-3.png" width="768" /></p>
<pre class="r"><code>dfALEIPA = df %&gt;% filter(Type == &quot;IPA&quot; | Type == &quot;ALE&quot;)
splitPerc = .70
trainIndices = sample(1:dim(dfALEIPA)[1],round(splitPerc * dim(dfALEIPA)[1]))
train = dfALEIPA[trainIndices,]
test = dfALEIPA[-trainIndices,]

## Get a visual of the relationship and see for nearest neighbor
par(mfrow=c(2,2)) #reset graphics device 
train %&gt;% ggplot(aes(x=ABV, y=IBU, color=Type)) + geom_point() + ggtitle(&quot;kNN Classification Graphing ABV vs IBU by IPA and ALE Beer Types&quot;)</code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-11-1.png" width="768" /></p>
<pre class="r"><code>## Separate visuals of ALE and IBU needed
### so to not misrepresent data

## Visual of train model for ALE
par(mfrow=c(2,2)) #reset graphics device 
plot_ALE = train %&gt;% filter(Type == &quot;ALE&quot;)
plot_ALE %&gt;% ggplot(aes(x=ABV, y=IBU, color=Type)) + geom_point() + ggtitle(&quot;ABV vs IBU by ALE Beer Type&quot;)</code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-12-1.png" width="768" /></p>
<pre class="r"><code>## Visual of train model for IPA
par(mfrow=c(2,2)) #reset graphics device 
plot_IPA = train %&gt;% filter(Type == &quot;IPA&quot;)
plot_IPA %&gt;% ggplot(aes(x=ABV, y=IBU, color=Type)) + geom_point() + ggtitle(&quot;ABV vs IBU by IPA Beer Type&quot;)</code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-12-2.png" width="768" /> # kNN analysis ## Conduct the k-NN</p>
<pre class="r"><code>#What does a confusion matrix tell you:
#&quot;It is a summary of prediction results on a 
#classification problem. The number of correct and
#incorrect predictions are summarized with count values 
#and broken down by each class. This is the key to the 
#confusion matrix. The confusion matrix shows the ways 
#in which your classification model is confused when it 
#makes predictions. It gives you insight not only into 
#the errors being made by your classifier but more 
#importantly the types of errors that are being made.
#It is this breakdown that overcomes the limitation 
#of using classification accuracy alone.&quot;-machinelearningmastery.com

# Get the probabilities
# A confusion matrix is a summary of prediction results 
## on a classification problem.
## tes run at k=5
set.seed(2040) #for reproducibility
classifications = knn(train[,c(4,5)],test[,c(4,5)],train$Type, prob = TRUE, k = 5)
levels = rev(test$Type)
table(test$Type,classifications)</code></pre>
<pre><code>##      classifications
##       ALE IPA
##   ALE 308  40
##   IPA  47 110</code></pre>
<pre class="r"><code>confusionMatrix(table(test$Type,classifications))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      classifications
##       ALE IPA
##   ALE 308  40
##   IPA  47 110
##                                           
##                Accuracy : 0.8277          
##                  95% CI : (0.7919, 0.8596)
##     No Information Rate : 0.703           
##     P-Value [Acc &gt; NIR] : 0.00000000007685
##                                           
##                   Kappa : 0.5929          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.5201          
##                                           
##             Sensitivity : 0.8676          
##             Specificity : 0.7333          
##          Pos Pred Value : 0.8851          
##          Neg Pred Value : 0.7006          
##              Prevalence : 0.7030          
##          Detection Rate : 0.6099          
##    Detection Prevalence : 0.6891          
##       Balanced Accuracy : 0.8005          
##                                           
##        &#39;Positive&#39; Class : ALE             
## </code></pre>
<pre class="r"><code>#do for k=15
set.seed(2040) #for reproducibility
classifications = knn(train[,c(4,5)],test[,c(4,5)],train$Type, prob = TRUE, k = 15)
table(test$Type,classifications)</code></pre>
<pre><code>##      classifications
##       ALE IPA
##   ALE 313  35
##   IPA  63  94</code></pre>
<pre class="r"><code>confusionMatrix(table(test$Type,classifications))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      classifications
##       ALE IPA
##   ALE 313  35
##   IPA  63  94
##                                           
##                Accuracy : 0.8059          
##                  95% CI : (0.7687, 0.8395)
##     No Information Rate : 0.7446          
##     P-Value [Acc &gt; NIR] : 0.0006986       
##                                           
##                   Kappa : 0.5238          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0063833       
##                                           
##             Sensitivity : 0.8324          
##             Specificity : 0.7287          
##          Pos Pred Value : 0.8994          
##          Neg Pred Value : 0.5987          
##              Prevalence : 0.7446          
##          Detection Rate : 0.6198          
##    Detection Prevalence : 0.6891          
##       Balanced Accuracy : 0.7806          
##                                           
##        &#39;Positive&#39; Class : ALE             
## </code></pre>
<pre class="r"><code>head(dfALEIPA)</code></pre>
<pre><code>##   Brewery_id          Beer Beer_ID   ABV IBU                   Style Ounces
## 1          1  Get Together    2692 0.045  50            American IPA     16
## 2          1    Wall&#39;s End    2690 0.048  19       English Brown Ale     16
## 3          1    Stronghold    2688 0.060  25         American Porter     16
## 4          1 Maggie&#39;s Leap    2691 0.049  26      Milk / Sweet Stout     16
## 5          1       Pumpion    2689 0.060  38             Pumpkin Ale     16
## 6          2        A Beer    2683 0.042  42 American Pale Ale (APA)     16
##   Type                   Brewery        City State    Region
## 1  IPA        NorthGate Brewing  Minneapolis    MN   Midwest
## 2  ALE        NorthGate Brewing  Minneapolis    MN   Midwest
## 3  ALE        NorthGate Brewing  Minneapolis    MN   Midwest
## 4  ALE        NorthGate Brewing  Minneapolis    MN   Midwest
## 5  ALE        NorthGate Brewing  Minneapolis    MN   Midwest
## 6  ALE Against the Grain Brewery  Louisville    KY Southeast</code></pre>
<pre class="r"><code>#check Type as factor
levels(dfALEIPA$Type)</code></pre>
<pre><code>## NULL</code></pre>
<div id="do-reverse-levels-for-confusion-matrix-table" class="section level2">
<h2>Do reverse levels for confusion matrix table:</h2>
<pre class="r"><code>dfALEIPA$Type &lt;- fct_rev(dfALEIPA$Type)
levels(dfALEIPA$Type)</code></pre>
<pre><code>## [1] &quot;IPA&quot; &quot;ALE&quot;</code></pre>
</div>
</div>
<div id="knn-analysis---continued" class="section level1">
<h1>kNN analysis - continued</h1>
<div id="re-run-k15-with-type-reversed" class="section level2">
<h2>re-run k=15 with Type reversed</h2>
<pre class="r"><code>set.seed(2040) #for reproducibility
classifications = knn(train[,c(4,5)],test[,c(4,5)],train$Type, prob = TRUE, k = 15)
table(test$Type,classifications)</code></pre>
<pre><code>##      classifications
##       ALE IPA
##   ALE 313  35
##   IPA  63  94</code></pre>
<pre class="r"><code>confusionMatrix(table(test$Type,classifications))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      classifications
##       ALE IPA
##   ALE 313  35
##   IPA  63  94
##                                           
##                Accuracy : 0.8059          
##                  95% CI : (0.7687, 0.8395)
##     No Information Rate : 0.7446          
##     P-Value [Acc &gt; NIR] : 0.0006986       
##                                           
##                   Kappa : 0.5238          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0063833       
##                                           
##             Sensitivity : 0.8324          
##             Specificity : 0.7287          
##          Pos Pred Value : 0.8994          
##          Neg Pred Value : 0.5987          
##              Prevalence : 0.7446          
##          Detection Rate : 0.6198          
##    Detection Prevalence : 0.6891          
##       Balanced Accuracy : 0.7806          
##                                           
##        &#39;Positive&#39; Class : ALE             
## </code></pre>
</div>
</div>
<div id="obtain-optimal-k-value-for-the-knn-model" class="section level1">
<h1>Obtain optimal k value for the kNN model</h1>
<pre class="r"><code>type_accuracy &lt;- data.frame(accuract=numeric(75), k=numeric(75))
for (iter in 1:75) {
  type_class &lt;- knn(train[,c(4,5)], test[c(4,5)],
                     train$Type,
                     prob=TRUE, k=iter)
  table(test$Type, type_class)
  cm &lt;- confusionMatrix(table(test$Type, type_class))
  type_accuracy$accuracy[iter] &lt;- cm$overall[1]
  type_accuracy$k[iter] &lt;- iter
}

#plot of optimal k
par(mfrow=c(2,2)) #reset graphics device 
figure &lt;- plot_ly(type_accuracy, x=type_accuracy$k, y=type_accuracy$accuracy, 
              type=&quot;scatter&quot;, mode=&quot;lines&quot;)
figure &lt;- figure %&gt;% layout(title=&#39;Optimal k for Model&#39;,
            xaxis = list(title = &#39;K value&#39;,
                          zeroline=TRUE),
            yaxis = list(title = &#39;Accuracy&#39;))
figure</code></pre>
<p><div id="htmlwidget-a030466479b41ab40573" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a030466479b41ab40573">{"x":{"visdat":{"136c50f4d6b":["function () ","plotlyVisDat"]},"cur_data":"136c50f4d6b","attrs":{"136c50f4d6b":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],"y":[0.798019801980198,0.796039603960396,0.817821782178218,0.813861386138614,0.825742574257426,0.81980198019802,0.813861386138614,0.807920792079208,0.805940594059406,0.807920792079208,0.803960396039604,0.801980198019802,0.803960396039604,0.798019801980198,0.807920792079208,0.786138613861386,0.8,0.796039603960396,0.801980198019802,0.801980198019802,0.805940594059406,0.803960396039604,0.803960396039604,0.8,0.8,0.8,0.8,0.803960396039604,0.807920792079208,0.803960396039604,0.803960396039604,0.803960396039604,0.807920792079208,0.803960396039604,0.805940594059406,0.8,0.801980198019802,0.8,0.803960396039604,0.796039603960396,0.796039603960396,0.8,0.801980198019802,0.794059405940594,0.796039603960396,0.794059405940594,0.798019801980198,0.796039603960396,0.796039603960396,0.794059405940594,0.796039603960396,0.796039603960396,0.796039603960396,0.8,0.792079207920792,0.796039603960396,0.798019801980198,0.798019801980198,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.801980198019802,0.801980198019802,0.801980198019802,0.801980198019802,0.801980198019802,0.801980198019802],"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Optimal k for Model","xaxis":{"domain":[0,1],"automargin":true,"title":"K value","zeroline":true},"yaxis":{"domain":[0,1],"automargin":true,"title":"Accuracy"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],"y":[0.798019801980198,0.796039603960396,0.817821782178218,0.813861386138614,0.825742574257426,0.81980198019802,0.813861386138614,0.807920792079208,0.805940594059406,0.807920792079208,0.803960396039604,0.801980198019802,0.803960396039604,0.798019801980198,0.807920792079208,0.786138613861386,0.8,0.796039603960396,0.801980198019802,0.801980198019802,0.805940594059406,0.803960396039604,0.803960396039604,0.8,0.8,0.8,0.8,0.803960396039604,0.807920792079208,0.803960396039604,0.803960396039604,0.803960396039604,0.807920792079208,0.803960396039604,0.805940594059406,0.8,0.801980198019802,0.8,0.803960396039604,0.796039603960396,0.796039603960396,0.8,0.801980198019802,0.794059405940594,0.796039603960396,0.794059405940594,0.798019801980198,0.796039603960396,0.796039603960396,0.794059405940594,0.796039603960396,0.796039603960396,0.796039603960396,0.8,0.792079207920792,0.796039603960396,0.798019801980198,0.798019801980198,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.803960396039604,0.801980198019802,0.801980198019802,0.801980198019802,0.801980198019802,0.801980198019802,0.801980198019802],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script> # Use Naive Bayes to compare against kNN…</p>
<pre class="r"><code>#Naive Bayes - continued
dfALEIPA = df %&gt;% filter(Type == &quot;IPA&quot; | Type == &quot;ALE&quot;)
splitPerc = .70

for(j in 1:iterations)
{
  trainIndices = sample(1:dim(dfALEIPA)[1],round(splitPerc * dim(dfALEIPA)[1]))
  train = dfALEIPA[trainIndices,]
  test = dfALEIPA[-trainIndices,]

  model = naiveBayes(train[,c(4,5)],as.factor(train$Type),laplace=1)
  table(predict(model,test[,c(4,5)]),as.factor(test$Type))
  CM=confusionMatrix(table(predict(model,test[,c(4,5)]),as.factor(test$Type)))
  masterAcc[j]=CM$overall[1]  
}

MeanAcc=colMeans(masterAcc)
MeanAcc</code></pre>
<pre><code>## [1] 0.795703</code></pre>
<pre><code>## Error in naive_bayes.default(data, y, prior, laplace, usekernel, usepoisson, : naive_bayes(): Vector with prior probabilities should have 2 entries</code></pre>
<pre><code>## Error in plot(nb, which = c(&quot;ABV&quot;, &quot;IBU&quot;), ask = TRUE, arg.num = list(col = 1:3, : object &#39;nb&#39; not found</code></pre>
</div>
<div id="how-about-a-third-test-one-that-tests-medians-between-abv-v-ibu-for-ipas-and-abv-v-ibu-for-ales" class="section level1">
<h1>How about a third test – one that tests medians between ABV v IBU for IPAs and ABV v IBU for Ales?</h1>
<div id="try-the-wilcox-ranked-sum-test-for-difference-in-medians" class="section level2">
<h2>Try the wilcox ranked sum test for difference in medians</h2>
<pre class="r"><code>#Type -&gt; ABV | IBU| Diff ABV-IBU | Absolute Diff ABV-IBU | Rank

#test run of wilcox.test()
resABVIBU &lt;- wilcox.test(dfALEIPA$ABV, dfALEIPA$IBU, exact=FALSE, mu=0, conf.int=T, 
                   conf.level=0.95, correct=F)
resABVIBU</code></pre>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  dfALEIPA$ABV and dfALEIPA$IBU
## W = 1092622, p-value &lt; 0.00000000000000022
## alternative hypothesis: true location shift is not equal to 0
## 95 percent confidence interval:
##  -23.94701 -19.95002
## sample estimates:
## difference in location 
##              -21.94001</code></pre>
<pre class="r"><code>#for ABV
res &lt;- wilcox.test(ABV ~ Type, data=dfALEIPA, exact=FALSE, mu=0, conf.int=T, 
                   conf.level=0.95, correct=F)
res</code></pre>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  ABV by Type
## W = 155661, p-value &lt; 0.00000000000000022
## alternative hypothesis: true location shift is not equal to 0
## 95 percent confidence interval:
##  -0.01299753 -0.01093057
## sample estimates:
## difference in location 
##            -0.01194392</code></pre>
<pre class="r"><code>#get p-value
res$p.value</code></pre>
<pre><code>## [1] 0.0000000000000000000000000000000000000000000000000000000000000002235033</code></pre>
<pre class="r"><code>#Reject the null - p-value (2.235033e-64)is significant (less than alpha of .05) 
#to suggest that we reject the null that median ABV for IPA and Ale
#is equal (actually, it is not equal)</code></pre>
<pre class="r"><code>#for IBU
res2 &lt;- wilcox.test(IBU ~ Type, data=dfALEIPA, exact=FALSE, mu=0, conf.int=T, 
                   conf.level=0.95, correct=F)
res2</code></pre>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  IBU by Type
## W = 174239, p-value &lt; 0.00000000000000022
## alternative hypothesis: true location shift is not equal to 0
## 95 percent confidence interval:
##  -39.99993 -31.99996
## sample estimates:
## difference in location 
##                    -35</code></pre>
<pre class="r"><code>#get p-value
res2$p.value</code></pre>
<pre><code>## [1] 0.00000000000000000000000000000000000000000000000000001126087</code></pre>
<pre class="r"><code>#Reject the null - p-value (1.127045e-53) is significant (less than alpha of .05) 
#to suggest that we reject the null that median IBU for IPA and Ale
#is equal (actually, it is not equal)</code></pre>
<pre class="r"><code>#correlation analysis
library(Hmisc)
cor(dfALEIPA$ABV, dfALEIPA$IBU)</code></pre>
<pre><code>## [1] 0.3906903</code></pre>
</div>
</div>
<div id="visualize-correlations" class="section level1">
<h1>Visualize correlations</h1>
<pre class="r"><code>library(GGally)
#Correlation plot of data
par(mfrow=c(2,2)) #reset graphics device 
ggpairs(dfALEIPA, columns = 4:5, ggplot2::aes(colour=Type)) +  ggtitle(&quot;Correlation Plot of ABV vs IBU by Beer Type&quot;) </code></pre>
<p><img src="Brewery-Project-Code_files/figure-html/unnamed-chunk-27-1.png" width="768" /> # Conclusion of Wilcoxon Rank Sum Test and overall problem analysis:</p>
<pre class="r"><code>#p-value is significant in rejecting the null hypothesis that ABV v IBU by
#the two beer types is equal.  </code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
